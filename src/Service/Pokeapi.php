<?php

namespace App\Service;

use Symfony\Contracts\Cache\CacheInterface;
use Symfony\Contracts\HttpClient\HttpClientInterface;

class Pokeapi
{
    private array $map = [
        'bulbizarre'=>1,'bulbasaur'=>1,'herbizarre'=>2,'ivysaur'=>2,'florizarre'=>3,'venusaur'=>3,'salameche'=>4,'charmander'=>4,'reptincel'=>5,'charmeleon'=>5,'dracaufeu'=>6,'charizard'=>6,'carapuce'=>7,'squirtle'=>7,'carabaffe'=>8,'wartortle'=>8,'tortank'=>9,'blastoise'=>9,'chenipan'=>10,'caterpie'=>10,'chrysacier'=>11,'metapod'=>11,'papilusion'=>12,'butterfree'=>12,'aspicot'=>13,'weedle'=>13,'coconfort'=>14,'kakuna'=>14,'dardargnan'=>15,'beedrill'=>15,'roucool'=>16,'pidgey'=>16,'roucoups'=>17,'pidgeotto'=>17,'roucarnage'=>18,'pidgeot'=>18,'rattata'=>19,'rattata'=>19,'rattatac'=>20,'raticate'=>20,'piafabec'=>21,'spearow'=>21,'rapasdepic'=>22,'fearow'=>22,'abo'=>23,'ekans'=>23,'arbok'=>24,'arbok'=>24,'pikachu'=>25,'pikachu'=>25,'raichu'=>26,'raichu'=>26,'sabelette'=>27,'sandshrew'=>27,'sablaireau'=>28,'sandslash'=>28,'nidoranf'=>29,'nidoran-f'=>29,'nidorina'=>30,'nidorina'=>30,'nidoking'=>31,'nidoking'=>31,'nidoranm'=>32,'nidoran-m'=>32,'nidorino'=>33,'nidorino'=>33,'nidoking'=>34,'nidoking'=>34,'melofee'=>35,'clefairy'=>35,'melodelfe'=>36,'clefable'=>36,'goupix'=>37,'vulpix'=>37,'feunard'=>38,'ninetales'=>38,'rondoudou'=>39,'jigglypuff'=>39,'groslem'=>40,'wigglytuff'=>40,'nosferapti'=>41,'zubat'=>41,'nosferalto'=>42,'golbat'=>42,'miaouss'=>43,'meowth'=>43,'persian'=>44,'persian'=>44,'psykokwak'=>45,'psyduck'=>45,'akwat'=>46,'golduck'=>46,'ferosinge'=>47,'mankey'=>47,'colossinge'=>48,'primeape'=>48,'ramoloss'=>49,'slowpoke'=>49,'flagadoss'=>50,'slowbro'=>50,'magnéti'=>81,'magnemite'=>81,'magnéton'=>82,'magneton'=>82,'caninos'=>58,'growlithe'=>58,'arcanin'=>59,'arcanine'=>59,'ptitard'=>60,'poliwag'=>60,'tetarte'=>61,'poliwhirl'=>61,'têtarte'=>61,'tartard'=>62,'poliwrath'=>62,'abra'=>63,'abra'=>63,'kadabra'=>64,'kadabra'=>64,'alakazam'=>65,'alakazam'=>65,'machoc'=>66,'machop'=>66,'machopeur'=>67,'machamp'=>67,'chenipotte'=>68,'bellsprout'=>68,'charmillon'=>69,'weepinbell'=>69,'papillusion'=>70,'victreebel'=>70,'tentacool'=>72,'tentacool'=>72,'tentacruel'=>73,'tentacruel'=>73,'geodude'=>74,'racaillou'=>74,'graveler'=>75,'gravalanch'=>75,'ponyta'=>77,'ponyta'=>77,'galopa'=>78,'rapidash'=>78,'ramoloss'=>79,'slowpoke'=>79,'flagadoss'=>80,'slowbro'=>80,'magnéti'=>81,'magnemite'=>81,'magnéton'=>82,'magneton'=>82,'caninos'=>83,'growlithe'=>83,'arcanin'=>84,'arcanine'=>84,'ptitard'=>85,'poliwag'=>85,'tetarte'=>86,'poliwhirl'=>86,'têtarte'=>86,'tartard'=>87,'poliwrath'=>87,'abra'=>88,'abra'=>88,'kadabra'=>89,'kadabra'=>89,'alakazam'=>90,'alakazam'=>90,'machoc'=>91,'machop'=>91,'machopeur'=>92,'machamp'=>92,'chenipotte'=>93,'bellsprout'=>93,'charmillon'=>94,'weepinbell'=>94,'victreebel'=>95,'tentacool'=>96,'tentacool'=>96,'tentacruel'=>97,'tentacruel'=>97,'geodude'=>98,'racaillou'=>98,'graveler'=>99,'gravalanch'=>99,'ponyta'=>100,'ponyta'=>100,'galopa'=>101,'rapidash'=>101,'ramoloss'=>102,'slowpoke'=>102,'flagadoss'=>103,'slowbro'=>103,'magnéti'=>104,'magnemite'=>104,'magnéton'=>105,'magneton'=>105,'caninos'=>106,'growlithe'=>106,'arcanin'=>107,'arcanine'=>107,'ptitard'=>108,'poliwag'=>108,'tetarte'=>109,'poliwhirl'=>109,'têtarte'=>109,'tartard'=>110,'poliwrath'=>110,'abra'=>111,'abra'=>111,'kadabra'=>112,'kadabra'=>112,'alakazam'=>113,'alakazam'=>113,'machoc'=>114,'machop'=>114,'machopeur'=>115,'machamp'=>115,'chenipotte'=>116,'bellsprout'=>116,'charmillon'=>117,'weepinbell'=>117,'victreebel'=>118,'tentacool'=>119,'tentacool'=>119,'tentacruel'=>120,'tentacruel'=>120,'geodude'=>121,'racaillou'=>121,'graveler'=>122,'gravalanch'=>122,'ponyta'=>123,'ponyta'=>123,'galopa'=>124,'rapidash'=>124,'ramoloss'=>125,'slowpoke'=>125,'flagadoss'=>126,'slowbro'=>126,'magnéti'=>127,'magnemite'=>127,'magnéton'=>128,'magneton'=>128,'caninos'=>129,'growlithe'=>129,'arcanin'=>130,'arcanine'=>130,'ptitard'=>131,'poliwag'=>131,'tetarte'=>132,'poliwhirl'=>132,'têtarte'=>132,'tartard'=>133,'poliwrath'=>133,'abra'=>134,'abra'=>134,'kadabra'=>135,'kadabra'=>135,'alakazam'=>136,'alakazam'=>136,'machoc'=>137,'machop'=>137,'machopeur'=>138,'machamp'=>138,'chenipotte'=>139,'bellsprout'=>139,'charmillon'=>140,'weepinbell'=>140,'victreebel'=>141,'tentacool'=>142,'tentacool'=>142,'tentacruel'=>143,'tentacruel'=>143,'geodude'=>144,'racaillou'=>144,'graveler'=>145,'gravalanch'=>145,'ponyta'=>146,'ponyta'=>146,'galopa'=>147,'rapidash'=>147,'ramoloss'=>148,'slowpoke'=>148,'flagadoss'=>149,'slowbro'=>149,'magnéti'=>150,'magnemite'=>150,'magnéton'=>151,'magneton'=>151,
        'germignon'=>152,'chikorita'=>152,'macronium'=>153,'bayleef'=>153,'meganium'=>154,'meganium'=>154,'hericendre'=>155,'cyndaquil'=>155,'feurisson'=>156,'quilava'=>156,'typhlosion'=>157,'typhlosion'=>157,'kaiminus'=>158,'totodile'=>158,'crocrodil'=>159,'croconaw'=>159,'aligatueur'=>160,'feraligatr'=>160,'fouinette'=>161,'sentret'=>161,'fouinar'=>162,'furret'=>162,'hoothoot'=>163,'hoothoot'=>163,'noarfang'=>164,'noctowl'=>164,'ledyba'=>165,'ledyba'=>165,'ledian'=>166,'ledian'=>166,'spinarak'=>167,'spinarak'=>167,'ariados'=>168,'ariados'=>168,'crobat'=>169,'crobat'=>169,'chinchidou'=>170,'chinchou'=>170,'lanturn'=>171,'lanturn'=>171,'pichu'=>172,'pichu'=>172,'melo'=>173,'cleffa'=>173,'toudoudou'=>174,'igglybuff'=>174,'togepi'=>175,'togepi'=>175,'togetic'=>176,'togetic'=>176,'natu'=>177,'natu'=>177,'xatu'=>178,'xatu'=>178,'wattouat'=>179,'mareep'=>179,'lainergie'=>180,'flaaffy'=>180,'pharamp'=>181,'ampharos'=>181,'bellossom'=>182,'bellossom'=>182,'marill'=>183,'marill'=>183,'azumarill'=>184,'azumarill'=>184,'roucoollet'=>185,'sudowoodo'=>185,'politoed'=>186,'politoed'=>186,'hoppip'=>187,'hoppip'=>187,'skiploom'=>188,'skiploom'=>188,'jumpluff'=>189,'jumpluff'=>189,'aipom'=>190,'aipom'=>190,'sunkern'=>191,'sunkern'=>191,'sunflora'=>192,'sunflora'=>192,'yanma'=>193,'yanma'=>193,'wooper'=>194,'wooper'=>194,'quagsire'=>195,'quagsire'=>195,'espeon'=>196,'espeon'=>196,'umbreon'=>197,'umbreon'=>197,'murkrow'=>198,'murkrow'=>198,'slowking'=>199,'slowking'=>199,'misdreavus'=>200,'misdreavus'=>200,'unown'=>201,'unown'=>201,'wobbuffet'=>202,'wobbuffet'=>202,'girafarig'=>203,'girafarig'=>203,'pineco'=>204,'pineco'=>204,'forretress'=>205,'forretress'=>205,'dunsparce'=>206,'dunsparce'=>206,'gligar'=>207,'gligar'=>207,'steelix'=>208,'steelix'=>208,'snubbull'=>209,'snubbull'=>209,'granbull'=>210,'granbull'=>210,'qwilfish'=>211,'qwilfish'=>211,'scizor'=>212,'scizor'=>212,'shuckle'=>213,'shuckle'=>213,'heracross'=>214,'heracross'=>214,'sneasel'=>215,'sneasel'=>215,'teddiursa'=>216,'teddiursa'=>216,'ursaring'=>217,'ursaring'=>217,'slugma'=>218,'slugma'=>218,'magcargo'=>219,'magcargo'=>219,'swinub'=>220,'swinub'=>220,'piloswine'=>221,'piloswine'=>221,'corsola'=>222,'corsola'=>222,'remoraid'=>223,'remoraid'=>223,'octillery'=>224,'octillery'=>224,'delibird'=>225,'delibird'=>225,'mantine'=>226,'mantine'=>226,'skarmory'=>227,'skarmory'=>227,'houndour'=>228,'houndour'=>228,'houndoom'=>229,'houndoom'=>229,'kingdra'=>230,'kingdra'=>230,'phanpy'=>231,'phanpy'=>231,'donphan'=>232,'donphan'=>232,'porygon2'=>233,'porygon2'=>233,'stantler'=>234,'stantler'=>234,'smeargle'=>235,'smeargle'=>235,'tyrogue'=>236,'tyrogue'=>236,'hitmontop'=>237,'hitmontop'=>237,'smoochum'=>238,'smoochum'=>238,'elekid'=>239,'elekid'=>239,'magby'=>240,'magby'=>240,'miltank'=>241,'miltank'=>241,'blissey'=>242,'blissey'=>242,'raikou'=>243,'raikou'=>243,'entei'=>244,'entei'=>244,'suicune'=>245,'suicune'=>245,'larvitar'=>246,'larvitar'=>246,'pupitar'=>247,'pupitar'=>247,'tyranitar'=>248,'tyranitar'=>248,'lugia'=>249,'lugia'=>249,'hooh'=>250,'hooh'=>250,'celebi'=>251,'celebi'=>251,
        'arcko'=>252,'treecko'=>252,'massko'=>253,'grovyle'=>253,'jungko'=>254,'sceptile'=>254,'poussifeu'=>255,'torchic'=>255,'galifeu'=>256,'combusken'=>256,'brasegali'=>257,'blaziken'=>257,'gobou'=>258,'mudkip'=>258,'flobio'=>259,'marshtomp'=>259,'laggron'=>260,'swampert'=>260,'medhyena'=>261,'poochyena'=>261,'grahyena'=>262,'mightyena'=>262,'zigzaton'=>263,'zigzagoon'=>263,'lîneon'=>264,'linoone'=>264,'chenipotte'=>265,'wurmple'=>265,'poklawa'=>266,'silcoon'=>266,'beautifly'=>267,'beautifly'=>267,'cascoon'=>268,'cascoon'=>268,'dustox'=>269,'dustox'=>269,'lotad'=>270,'lotad'=>270,'lombre'=>271,'lombre'=>271,'ludicolo'=>272,'ludicolo'=>272,'seedot'=>273,'seedot'=>273,'nuzleaf'=>274,'nuzleaf'=>274,'shiftry'=>275,'shiftry'=>275,'nilperl'=>276,'taillow'=>276,'swellow'=>277,'swellow'=>277,'wingull'=>278,'wingull'=>278,'pelipper'=>279,'pelipper'=>279,'ralts'=>280,'ralts'=>280,'kirlia'=>281,'kirlia'=>281,'gardevoir'=>282,'gardevoir'=>282,'surskit'=>283,'surskit'=>283,'masquerain'=>284,'masquerain'=>284,'shroomish'=>285,'shroomish'=>285,'breloom'=>286,'breloom'=>286,'slakoth'=>287,'slakoth'=>287,'vigoroth'=>288,'vigoroth'=>288,'slaking'=>289,'slaking'=>289,'nincada'=>290,'nincada'=>290,'ninjask'=>291,'ninjask'=>291,'shedinja'=>292,'shedinja'=>292,'whismur'=>293,'whismur'=>293,'loudred'=>294,'loudred'=>294,'exploud'=>295,'exploud'=>295,'makuhita'=>296,'makuhita'=>296,'hariyama'=>297,'hariyama'=>297,'azurill'=>298,'azurill'=>298,'nosepass'=>299,'nosepass'=>299,'skitty'=>300,'skitty'=>300,'delcatty'=>301,'delcatty'=>301,'sablette'=>302,'sablette'=>302,'mawile'=>303,'mawile'=>303,'aron'=>304,'aron'=>304,'lairon'=>305,'lairon'=>305,'aggron'=>306,'aggron'=>306,'meditikka'=>307,'meditite'=>307,'charmina'=>308,'medicham'=>308,'electrike'=>309,'electrike'=>309,'manectric'=>310,'manectric'=>310,'plusle'=>311,'plusle'=>311,'minun'=>312,'minun'=>312,'volbeat'=>313,'volbeat'=>313,'illumise'=>314,'illumise'=>314,'roselia'=>315,'roselia'=>315,'gulpin'=>316,'gulpin'=>316,'swalot'=>317,'swalot'=>317,'carvanha'=>318,'carvanha'=>318,'sharpedo'=>319,'sharpedo'=>319,'wailmer'=>320,'wailmer'=>320,'wailord'=>321,'wailord'=>321,'numel'=>322,'numel'=>322,'camerupt'=>323,'camerupt'=>323,'torkoal'=>324,'torkoal'=>324,'spoink'=>325,'spoink'=>325,'grumpig'=>326,'grumpig'=>326,'spinda'=>327,'spinda'=>327,'trapinch'=>328,'trapinch'=>328,'vibrava'=>329,'vibrava'=>329,'flygon'=>330,'flygon'=>330,'cacnea'=>331,'cacnea'=>331,'cacturne'=>332,'cacturne'=>332,'swablu'=>333,'swablu'=>333,'altaria'=>334,'altaria'=>334,'zangoose'=>335,'zangoose'=>335,'seviper'=>336,'seviper'=>336,'lunatone'=>337,'lunatone'=>337,'solrock'=>338,'solrock'=>338,'barboach'=>339,'barboach'=>339,'whiscash'=>340,'whiscash'=>340,'corphish'=>341,'corphish'=>341,'crawdaunt'=>342,'crawdaunt'=>342,'baltoy'=>343,'baltoy'=>343,'claydol'=>344,'claydol'=>344,'lileep'=>345,'lileep'=>345,'cradily'=>346,'cradily'=>346,'anorith'=>347,'anorith'=>347,'armaldo'=>348,'armaldo'=>348,'feebas'=>349,'feebas'=>349,'milotic'=>350,'milotic'=>350,'castform'=>351,'castform'=>351,'kecleon'=>352,'kecleon'=>352,'shuppet'=>353,'shuppet'=>353,'banette'=>354,'banette'=>354,'duskull'=>355,'duskull'=>355,'dusclops'=>356,'dusclops'=>356,'tropius'=>357,'tropius'=>357,'chimecho'=>358,'chimecho'=>358,'absol'=>359,'absol'=>359,'wynaut'=>360,'wynaut'=>360,'snorunt'=>361,'snorunt'=>361,'glalie'=>362,'glalie'=>362,'spheal'=>363,'spheal'=>363,'sealeo'=>364,'sealeo'=>364,'walrein'=>365,'walrein'=>365,'clamperl'=>366,'clamperl'=>366,'huntail'=>367,'huntail'=>367,'gorebyss'=>368,'gorebyss'=>368,'relicanth'=>369,'relicanth'=>369,'luvdisc'=>370,'luvdisc'=>370,'bagon'=>371,'bagon'=>371,'shelgon'=>372,'shelgon'=>372,'salamence'=>373,'salamence'=>373,'beldum'=>374,'beldum'=>374,'metang'=>375,'metang'=>375,'metagross'=>376,'metagross'=>376,'regirock'=>377,'regirock'=>377,'regice'=>378,'regice'=>378,'registeel'=>379,'registeel'=>379,'latias'=>380,'latias'=>380,'latios'=>381,'latios'=>381,'kyogre'=>382,'kyogre'=>382,'groudon'=>383,'groudon'=>383,'rayquaza'=>384,'rayquaza'=>384,'jirachi'=>385,'jirachi'=>385,'deoxys'=>386,'deoxys'=>386,
        'tortipouss'=>387,'turtwig'=>387,'boskara'=>388,'grotle'=>388,'torterra'=>389,'torterra'=>389,'ouisticram'=>390,'chimchar'=>390,'chimpenfeu'=>391,'monferno'=>391,'simiabraz'=>392,'infernape'=>392,'tiplouf'=>393,'piplup'=>393,'prinplouf'=>394,'prinplup'=>394,'pingoleon'=>395,'empoleon'=>395,'etourmi'=>396,'starly'=>396,'etourvol'=>397,'staravia'=>397,'etouraptor'=>398,'staraptor'=>398,'keunotor'=>399,'bidoof'=>399,'castorno'=>400,'bibarel'=>400,'crikzik'=>401,'kricketot'=>401,'melokrik'=>402,'kricketune'=>402,'lixy'=>403,'shinx'=>403,'luxio'=>404,'luxio'=>404,'luxray'=>405,'luxray'=>405,'rozbouton'=>406,'budew'=>406,'roserade'=>407,'roserade'=>407,'kranidos'=>408,'cranidos'=>408,'charkos'=>409,'rampardos'=>409,'dinoclier'=>410,'shieldon'=>410,'bastiodon'=>411,'bastiodon'=>411,'burmy'=>412,'burmy'=>412,'wormadam'=>413,'wormadam'=>413,'mothim'=>414,'mothim'=>414,'combee'=>415,'combee'=>415,'vespiquen'=>416,'vespiquen'=>416,'pachirisu'=>417,'pachirisu'=>417,'boumata'=>418,'buizel'=>418,'floatzel'=>419,'floatzel'=>419,'ceribou'=>420,'cherubi'=>420,'ceriflor'=>421,'cherrim'=>421,'shellos'=>422,'shellos'=>422,'gastrodon'=>423,'gastrodon'=>423,'ambipom'=>424,'ambipom'=>424,'fantominus'=>425,'drifloon'=>425,'spectreblim'=>426,'drifblim'=>426,'lopunny'=>427,'lopunny'=>427,'mystherbe'=>428,'mismagius'=>428,'honchkrow'=>429,'honchkrow'=>429,'gremlem'=>430,'glameow'=>430,'chaffreux'=>431,'purugly'=>431,'chingling'=>432,'chingling'=>432,'moufouette'=>433,'stunky'=>433,'moufouette_foncee'=>434,'skuntank'=>434,'bronzor'=>435,'bronzor'=>435,'bronzong'=>436,'bronzong'=>436,'bonsly'=>437,'bonsly'=>437,'mimejr'=>438,'mime jr'=>438,'mime jr.'=>438,'mimejunior'=>438,'happiny'=>439,'happiny'=>439,'chatot'=>440,'chatot'=>440,'spirited'=>441,'spiritomb'=>441,'gibel'=>442,'gible'=>442,'gabite'=>443,'gabite'=>443,'garchomp'=>444,'garchomp'=>444,'moumouflon'=>445,'munchlax'=>445,'riolu'=>446,'riolu'=>446,'lucario'=>447,'lucario'=>447,'hippopotas'=>448,'hippopotas'=>448,'hippowdon'=>449,'hippowdon'=>449,'skorupi'=>450,'skorupi'=>450,'drapion'=>451,'drapion'=>451,'croagunk'=>452,'croagunk'=>452,'toxicroak'=>453,'toxicroak'=>453,'carnivine'=>454,'carnivine'=>454,'finneon'=>455,'finneon'=>455,'lumineon'=>456,'lumineon'=>456,'mantyke'=>457,'mantyke'=>457,'snover'=>458,'snover'=>458,'abomasnow'=>459,'abomasnow'=>459,'weavile'=>460,'weavile'=>460,'magnezone'=>461,'magnezone'=>461,'lilipup'=>462,'lickilicky'=>462,'hippowdon_aur'=>462,'rhyperior'=>463,'rhyperior'=>463,'tangrowth'=>464,'tangrowth'=>464,'electivire'=>465,'electivire'=>465,'magmortar'=>466,'magmortar'=>466,'togekiss'=>467,'togekiss'=>467,'yanmega'=>468,'yanmega'=>468,'leafeon'=>469,'leafeon'=>469,'glaceon'=>470,'glaceon'=>470,'gliscor'=>471,'gliscor'=>471,'mamoswine'=>472,'mamoswine'=>472,'porygon_z'=>473,'porygon-z'=>473,'gallade'=>474,'gallade'=>474,'probopass'=>475,'probopass'=>475,'dusknoir'=>476,'dusknoir'=>476,'froslass'=>477,'froslass'=>477,'rotom'=>478,'rotom'=>478,'rotom_chaud'=>478,'rotom_wash'=>478,'rotom_frost'=>478,'rotom_fan'=>478,'rotom_mow'=>478,'uxie'=>479,'uxie'=>479,'mesprit'=>480,'mesprit'=>480,'azelf'=>481,'azelf'=>481,'dialga'=>482,'dialga'=>482,'palkia'=>483,'palkia'=>483,'heatran'=>484,'heatran'=>484,'regigigas'=>485,'regigigas'=>485,'giratina_origin'=>486,'giratina_altered'=>486,'cresselia'=>487,'cresselia'=>487,'phione'=>488,'phione'=>488,'manaphy'=>489,'manaphy'=>489,'darkrai'=>490,'darkrai'=>490,'shaymin_land'=>491,'shaymin_sky'=>491,'arceus'=>492,'arceus'=>492,
        'vipelierre'=>494,'snivy'=>494,'majaspic'=>495,'servine'=>495,'majestos'=>496,'serperior'=>496,'gruikui'=>497,'tepig'=>497,'grotichon'=>498,'pignite'=>498,'roboroi'=>499,'emboar'=>499,'moustillon'=>500,'oshawott'=>500,'mateloutre'=>501,'dewott'=>501,'clamiral'=>502,'samurott'=>502,'passerouge'=>503,'patrat'=>503,'boucmer'=>504,'watchog'=>504,'wurli'=>505,'lillipup'=>505,'herdier'=>506,'herdier'=>506,'mastouffe'=>507,'stoutland'=>507,'zingli'=>508,'purrloin'=>508,'liligant'=>509,'liepard'=>509,'pelipper'=>510,'pansage'=>510,'simisage'=>511,'pansear'=>512,'simisear'=>512,'panpour'=>513,'simipour'=>513,'munna'=>514,'munna'=>514,'musharna'=>515,'musharna'=>515,'poipole'=>516,'pidove'=>516,'tranquill'=>517,'tranquill'=>517,'unfezant'=>518,'unfezant'=>518,'blitzle'=>519,'zebstrika'=>519,'roggenrola'=>520,'boldore'=>520,'gigalith'=>521,'woobat'=>521,'swoobat'=>522,'drilbur'=>522,'excadrill'=>523,'audino'=>523,'timburr'=>524,'gurdurr'=>524,'conkeldurr'=>525,'tympole'=>525,'palpitoad'=>526,'seismitoad'=>526,'throh'=>527,'sawk'=>527,'sewaddle'=>528,'swadloon'=>528,'leavanny'=>529,'venipede'=>529,'whirlipede'=>530,'scolipede'=>530,'cottonee'=>531,'whimsicott'=>531,'petilil'=>532,'lilligant'=>532,'basculin'=>533,'sandile'=>533,'krokorok'=>534,'krookodile'=>534,'darumaka'=>535,'darmanitan'=>535,'maracachi'=>536,'maractus'=>536,'dwebble'=>537,'crustle'=>537,'scraggy'=>538,'scrafty'=>538,'sigilyph'=>539,'yamask'=>539,'cofagrigus'=>540,'tirtouga'=>540,'carracosta'=>541,'archen'=>541,'archeops'=>542,'trubbish'=>542,'garbodor'=>543,'zorua'=>543,'zorua'=>544,'zoroark'=>544,'minccino'=>545,'cinccino'=>545,'gothita'=>546,'gothorita'=>546,'gothitelle'=>547,'solosis'=>547,'duosion'=>548,'reuniclus'=>548,'ducklett'=>549,'swanna'=>549,'vanillite'=>550,'vanillish'=>550,'vanilluxe'=>551,'deerling'=>551,'sawsbuck'=>552,'emolga'=>552,'karrablast'=>553,'escavalier'=>553,'foongus'=>554,'amoonguss'=>554,'frillish'=>555,'jellicent'=>555,'alomomola'=>556,'joltik'=>556,'galvantula'=>557,'ferroseed'=>557,'ferrothorn'=>558,'klink'=>558,'klang'=>559,'klinklang'=>559,'tynamo'=>560,'eelektrik'=>560,'eelektross'=>561,'elgyem'=>561,'beheeyem'=>562,'litwick'=>562,'lampent'=>563,'chandelure'=>563,'axew'=>564,'fraxure'=>564,'haxorus'=>565,'cubchoo'=>565,'beartic'=>566,'cryogonal'=>566,'shelmet'=>567,'accelgor'=>567,'stunfisk'=>568,'stunfisk'=>568,'mienfoo'=>569,'mienshao'=>569,'druddigon'=>570,'golett'=>570,'golurk'=>571,'pawniard'=>571,'bisharp'=>572,'bouffalant'=>572,'rufflet'=>573,'braviary'=>573,'vullaby'=>574,'mandibuzz'=>574,'heatmor'=>575,'durant'=>575,'deino'=>576,'zweilous'=>576,'hydreigon'=>577,'larvesta'=>577,'volcarona'=>578,'cobalion'=>578,'terrakion'=>579,'virizion'=>579,'tornadus'=>580,'thundurus'=>580,'reshiram'=>581,'zekrom'=>582,'landorus'=>583,'kyurem'=>584,'keldeo'=>585,'meloetta'=>586,'genesect'=>587,
    ];

    public function __construct(private HttpClientInterface $client, private CacheInterface $cache, private int $pokemonCacheTtl) 
    {}

    public function pokemonGetSingle(string $name): array
    {
        return $this->cache->get('pokemon_' . strtolower($name), function($item) use ($name){
            try {
                $item->expiresAfter($this->pokemonCacheTtl);
                
                $pokemonResponse = $this->client->request('GET', 'https://pokeapi.co/api/v2/pokemon/' . strtolower($name));

                $pokemon = $pokemonResponse->toArray();

                $content = [
                    'sprite' => $pokemon['sprites']['other']['official-artwork']['front_default'],
                    'name' => $pokemon['name'],
                    'height' => $pokemon['height'] * 0.1,
                    'weight' => $pokemon['weight'] * 0.1,
                    'types' => array_map(fn($type) => $type['type']['name'], $pokemon['types']),
                    'stats'  => array_map(
                        fn($stat) => [
                            'name' => $stat['stat']['name'],
                            'base_stat' => $stat['base_stat'],
                        ],
                        $pokemon['stats']
                    )
                ];
                return $content;
            } catch (\Throwable) {
                $item->expiresAfter(0);
                return ['error' => true, 'message' => 'Impossible de récupérer ce Pokémon pour le moment.'];
            }
        });
    }

    public function pokemonGetAll(int $limit): array
    {
        return $this->cache->get('pokemon_list_' . $limit, function($item) use ($limit) {
            try {
                $item->expiresAfter($this->pokemonCacheTtl);
                
                $pokemonListResponse = $this->client->request('GET', 'https://pokeapi.co/api/v2/pokemon?limit=' . $limit);
                $pokemonList = $pokemonListResponse->toArray();

                $pokemonResponses = [];
                
                foreach ($pokemonList['results'] as $pokemon) {
                    $pokemonResponses[] = $this->client->request('GET', 'https://pokeapi.co/api/v2/pokemon/' . $pokemon['name']);
                }   

                $contents = [];
                foreach ($pokemonResponses as $pokemonResponse) {
                    $pokemon = $pokemonResponse->toArray();
  
                    $contents[] = [
                        'sprite' => $pokemon['sprites']['other']['official-artwork']['front_default'],
                        'name'   => $pokemon['name'],
                        'types'  => array_map(fn($type) => $type['type']['name'], $pokemon['types']),
                    ];
                }
                return $contents;
            } catch (\Throwable) {
                $item->expiresAfter(0);
                return ['error' => true, 'message' => 'Impossible de récupérer les Pokémons pour le moment.'];
            }
        });
    }

    public function nameFrtoEn(string $input): ?int
    {
        $key = strtolower($input);
        return $this->map[$key] ?? null;
    }
}